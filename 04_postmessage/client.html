<!DOCTYPE html>

<html>
  <head>
    <script>
      function log(msg) {
        var el = document.getElementById('log');
        el.innerHTML += '<br>' + msg;
      }

      function start() {
        log('Creating iframe');

        var el = document.createElement('iframe');
        var bd = document.getElementsByTagName('body')[0];

        el.style.display = 'none';
        el.src = 'http://localhost:9999/server.html';
        bd.appendChild(el);

        window.addEventListener('message', function (ev) {
          if (ev.origin != 'http://localhost:9999')
            return;

          log("Incoming: " + ev.data);
        });
      }
    </script>
  </head>

  <body>
    <button onclick="start()">Start</button>
    <pre id="log"></pre>
  </body>
</html>
